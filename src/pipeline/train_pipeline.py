#code for training - it calls all the components inside
